<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.58.3" />

<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">



<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/neuro/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/neuro/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/neuro/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/neuro/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/neuro/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/neuro/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/neuro/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/neuro/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/neuro/favicons/android-192x192.png" sizes="192x192">

<title>Dense | neuro</title><meta property="og:title" content="Dense" />
<meta property="og:description" content="This page is in a draft status.
Forward Pass During the forward pass, the inputs $o_{l-1}$, which correspond to the output of the previous layer for a hidden layer or to the training values for the input layer, are multiplied by the weights $W^{[l]}$ of the layer and the biases $b^{[l]}$ are added to form the linear activation:
$$z^{[l]}=W^{[l]}o_{l-1}&#43;b^{[l]}$$
The linear activation is then used as input for the activation function to compute the nonlinear activation of the layer:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://srenevey.github.io/neuro/docs/layers/dense/" />
<meta property="og:site_name" content="neuro" />
<meta itemprop="name" content="Dense">
<meta itemprop="description" content="This page is in a draft status.
Forward Pass During the forward pass, the inputs $o_{l-1}$, which correspond to the output of the previous layer for a hidden layer or to the training values for the input layer, are multiplied by the weights $W^{[l]}$ of the layer and the biases $b^{[l]}$ are added to form the linear activation:
$$z^{[l]}=W^{[l]}o_{l-1}&#43;b^{[l]}$$
The linear activation is then used as input for the activation function to compute the nonlinear activation of the layer:">



<meta itemprop="wordCount" content="453">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Dense"/>
<meta name="twitter:description" content="This page is in a draft status.
Forward Pass During the forward pass, the inputs $o_{l-1}$, which correspond to the output of the previous layer for a hidden layer or to the training values for the input layer, are multiplied by the weights $W^{[l]}$ of the layer and the biases $b^{[l]}$ are added to form the linear activation:
$$z^{[l]}=W^{[l]}o_{l-1}&#43;b^{[l]}$$
The linear activation is then used as input for the activation function to compute the nonlinear activation of the layer:"/>





<link rel="preload" href="/neuro/scss/main.min.f56263feacc37bb1eac4441644aa123f8fe15ea3188058988a0dc4db839cea02.css" as="style">
<link href="/neuro/scss/main.min.f56263feacc37bb1eac4441644aa123f8fe15ea3188058988a0dc4db839cea02.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  MathJax.Hub.Config({
    jax: ["input/TeX","output/CommonHTML"],
    tex2jax: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    fonts: ["TeX", "STIX"],
    CommonHTML: {
      scale: 100,
      mtextFontInherit: true,
    }
  });

  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script> 


    <title>Dense | neuro</title>
  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/neuro/">
		<span class="navbar-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" viewBox="0 0 13.147345 12.788828" id="svg8" inkscape:export-filename="/Users/sylvain/Developer/Rust_projects/neuro/www/assets/logo.png" inkscape:export-xdpi="96" inkscape:export-ydpi="96" inkscape:version="0.92.2 5c3e80d, 2017-08-06" sodipodi:docname="logo.svg"><defs id="defs2" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:zoom="1" inkscape:cx="69.202826" inkscape:cy="48.04465" inkscape:document-units="mm" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1680" inkscape:window-height="952" inkscape:window-x="0" inkscape:window-y="1" inkscape:window-maximized="1" inkscape:pagecheckerboard="true" showborder="true" borderlayer="false" inkscape:showpageshadow="false" /><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-13.436986,-26.062207)"><circle style="opacity:1;fill:#fff;fill-opacity:1;fill-rule:nonzero;stroke:#fff;stroke-width:.16900681;stroke-linecap:butt;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" id="path815" cx="19.974806" cy="27.222263" r="1.0755528" /><circle r="1.0755528" cy="31.332914" cx="25.424274" id="circle817" style="opacity:1;fill:#fff;fill-opacity:1;fill-rule:nonzero;stroke:#fff;stroke-width:.16900681;stroke-linecap:butt;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" /><circle style="opacity:1;fill:#fff;fill-opacity:1;fill-rule:nonzero;stroke:#fff;stroke-width:.16900681;stroke-linecap:butt;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" id="circle819" cx="14.597042" cy="31.332914" r="1.0755528" /><circle r="1.0755528" cy="37.690979" cx="16.533037" id="circle821" style="opacity:1;fill:#fff;fill-opacity:1;fill-rule:nonzero;stroke:#fff;stroke-width:.16900681;stroke-linecap:butt;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" /><circle style="opacity:1;fill:#fff;fill-opacity:1;fill-rule:nonzero;stroke:#fff;stroke-width:.16900681;stroke-linecap:butt;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" id="circle823" cx="23.631687" cy="37.690979" r="1.0755528" /><path style="fill:none;fill-opacity:1;stroke:#fff;stroke-width:.40561634;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m14.525339 31.309365 5.377764-4.158804 5.521171 4.158804-1.792588 6.381613-7.098648-.0717z" id="path829" inkscape:connector-curvature="0" /></g></svg></span><span class="font-weight-light">neuro</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link active" href="/neuro/docs/" ><span class="active">  Knowledge Base</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/neuro/examples/" ><span>  Examples</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/neuro/api/neuro/" ><span>   API Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="https://www.github.com/srenevey/neuro" target="_blank" ><span> <i class='fab fa-github'></i>  GitHub</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"></div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  
  <nav class="collapse td-sidebar-nav pt-2 pl-4" id="td-section-nav">
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/neuro/docs/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Knowledge Base</a>
  </li>
  <ul>
    <li class="collapse show" id="neuro-docs">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/neuro/docs/activations/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Activations</a>
  </li>
  <ul>
    <li class="collapse " id="neuro-docs-activations">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-neuro-docs-activations-linear" href="/neuro/docs/activations/linear/">Linear</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-neuro-docs-activations-relu" href="/neuro/docs/activations/relu/">ReLU</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-neuro-docs-activations-sigmoid" href="/neuro/docs/activations/sigmoid/">Sigmoid</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-neuro-docs-activations-softmax" href="/neuro/docs/activations/softmax/">Softmax</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-neuro-docs-activations-tanh" href="/neuro/docs/activations/tanh/">Tanh</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/neuro/docs/initializers/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Initializers</a>
  </li>
  <ul>
    <li class="collapse " id="neuro-docs-initializers">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/neuro/docs/layers/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Layers</a>
  </li>
  <ul>
    <li class="collapse show" id="neuro-docs-layers">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page  active" id="m-neuro-docs-layers-dense" href="/neuro/docs/layers/dense/">Dense</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/neuro/docs/losses/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Losses</a>
  </li>
  <ul>
    <li class="collapse " id="neuro-docs-losses">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-neuro-docs-losses-crossentropy" href="/neuro/docs/losses/crossentropy/">Cross Entropy</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-neuro-docs-losses-mae" href="/neuro/docs/losses/mae/">Mean Absolute Error</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-neuro-docs-losses-mse" href="/neuro/docs/losses/mse/">Mean Squared Error</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/neuro/docs/metrics/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Metrics</a>
  </li>
  <ul>
    <li class="collapse " id="neuro-docs-metrics">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/neuro/docs/optimizers/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Optimizers</a>
  </li>
  <ul>
    <li class="collapse " id="neuro-docs-optimizers">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-neuro-docs-optimizers-adadelta" href="/neuro/docs/optimizers/adadelta/">Adadelta</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-neuro-docs-optimizers-adam" href="/neuro/docs/optimizers/adam/">Adam</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-neuro-docs-optimizers-rmsprop" href="/neuro/docs/optimizers/rmsprop/">RMSProp</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-neuro-docs-optimizers-sgd" href="/neuro/docs/optimizers/sgd/">SGD</a>
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

  </nav>
</div>




          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            











          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="https://srenevey.github.io/neuro/docs/">Knowledge Base</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://srenevey.github.io/neuro/docs/layers/">Layers</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://srenevey.github.io/neuro/docs/layers/dense/">Dense</a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	<h1>Dense</h1>
	
	

<p>This page is in a draft status.</p>

<h2 id="forward-pass">Forward Pass</h2>

<p>During the forward pass, the inputs $o_{l-1}$, which correspond to the output of the previous layer for a hidden layer or to the training values for the input layer, are multiplied by the weights $W^{[l]}$ of the layer and the biases $b^{[l]}$ are added to form the linear activation:</p>

<p>$$z^{[l]}=W^{[l]}o_{l-1}+b^{[l]}$$</p>

<p>The linear activation is then used as input for the activation function to compute the nonlinear activation of the layer:</p>

<p>$$o_l = g(z^{[l]})$$</p>

<p>This value is the output of the layer and is passed on to the next layer or is used to compute the loss if it is the output layer.</p>

<h2 id="backward-pass">Backward Pass</h2>

<p>In the backward pass, we compute how the loss function used to train the model reacts to small variations in the weights, biases, and inputs. That is, if $\mathcal{L}$ is the loss function, we compute $\nabla_{W^{[l]}}\mathcal{L}$, $\nabla_{b^{[l]}}\mathcal{L}$, and $\nabla_{o_{l-1}}\mathcal{L}$. The input of the backward pass corresponds to the gradient of the loss function with respect to the output of the layer. That is, if $o_l^{\prime}$ is the input of the backward pass, we have</p>

<p>$$o^{\prime}_l \equiv \nabla_{o_l}\mathcal{L}$$</p>

<p>Applying the chain rule, we start by computing the partial derivative with respect to the weights:</p>

<p>$$\frac{\partial \mathcal{L}}{\partial W^{[l]}} = \frac{\partial \mathcal{L}}{\partial o_l}\frac{\partial o_l}{\partial W^{[l]}} = o_l^{\prime}\frac{\partial o_l}{\partial z^{[l]}}\frac{\partial z^{[l]}}{\partial W^{[l]}} = (o_l^{\prime}\odot g&rsquo;(z^{[l]}))o_{l-1}^T$$</p>

<p>where $\odot$ denotes the Hadamard product (i.e. element-wise product) and the transpose of $o_{l-1}$ is taken to have consistent dimensions. We then proceed with the partial derivative with respect to the biases:</p>

<p>$$\frac{\partial \mathcal{L}}{\partial b^{[l]}} = \frac{\partial \mathcal{L}}{\partial o_l}\frac{\partial o_l}{\partial b^{[l]}} = o_l^{\prime}\frac{\partial o_l}{\partial z^{[l]}}\frac{\partial z^{[l]}}{\partial b^{[l]}} = o_l^{\prime}\odot g&rsquo;(z^{[l]})$$</p>

<p>And finally, the partial derivatives with respect to the layer&rsquo;s inputs:</p>

<p>$$\frac{\partial \mathcal{L}}{\partial o_{l-1}} = \frac{\partial \mathcal{L}}{\partial o_l}\frac{\partial o_l}{\partial o_{l-1}} = o_l^{\prime}\frac{\partial o_l}{\partial z^{[l]}}\frac{\partial z^{[l]}}{\partial o_{l-1}} = {W^{[l]}}^T (o_l^{\prime}\odot g&rsquo;(z^{[l]}))$$</p>

<p>where the transpose of the weights is taken to have consistent dimensions. This last value is the output of the backward pass and is passed on to the previous layer. The following figure illustrates the forward and backward passes of the dense layer.</p>

<p><img class="center" width="320px" height="396.23px" src="/neuro/images/dense_layer.svg" /></p>

<p>The parameters of the layer are the weights and biases. During the forward pass, the parameters are used to compute the linear and nonlinear activations. The inputs and the linear activations are cached for later use by the backprop algorithm. During the backward pass, the parameters and the previously cached values are used to compute the gradients with respect to the weights and biases which are cached. These values will be used once the backprop algorithm has been computed for each layer. At that point, an optimizer will update all parameters in the network. Finally, the gradient with respect to the inputs is computed and returned.</p>

	
	
	
</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" href="https://github.com/srenevey">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="LinkedIn" aria-label="LinkedIn">
    <a class="text-white" target="_blank" href="https://linkedin.com/in/sylvainrenevey">
      <i class="fab fa-linkedin"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2020 Sylvain Renevey All Rights Reserved</small>
        
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>






<script src="/neuro/js/main.min.555f79c155b14abcbf7f908ba26d55566ce5a98281a1de7dc1d15956977b3dbe.js" integrity="sha256-VV95wVWxSry/f5CLom1VVmzlqYKBod59wdFZVpd7Pb4=" crossorigin="anonymous"></script>



  </body>
</html>